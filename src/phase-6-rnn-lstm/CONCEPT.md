# å¾ªç¯ç¥ç»ç½‘ç»œ RNN/LSTM æ·±åº¦è§£æ

> ä»é›¶å¼€å§‹ï¼Œå…¨é¢ç†è§£åºåˆ—å»ºæ¨¡çš„æ ¸å¿ƒæŠ€æœ¯

---

## ç›®å½•

1. [ä¸ºä»€ä¹ˆéœ€è¦ RNNï¼Ÿ](#1-ä¸ºä»€ä¹ˆéœ€è¦rnn)
2. [RNN åŸºç¡€æ¶æ„](#2-rnnåŸºç¡€æ¶æ„)
3. [RNN çš„æ•°å­¦åŸç†](#3-rnnçš„æ•°å­¦åŸç†)
4. [RNN çš„è‡´å‘½ç¼ºé™·](#4-rnnçš„è‡´å‘½ç¼ºé™·)
5. [LSTM è¯¦è§£](#5-lstmè¯¦è§£)
6. [GRUï¼šLSTM çš„ç®€åŒ–ç‰ˆ](#6-grulstmçš„ç®€åŒ–ç‰ˆ)
7. [ä»£ç å®ç°](#7-ä»£ç å®ç°)
8. [å®æˆ˜åº”ç”¨](#8-å®æˆ˜åº”ç”¨)
9. [æ€»ç»“ä¸å±•æœ›](#9-æ€»ç»“ä¸å±•æœ›)

---

## 1. ä¸ºä»€ä¹ˆéœ€è¦ RNNï¼Ÿ

### 1.1 ä¼ ç»Ÿç¥ç»ç½‘ç»œçš„å±€é™

```
ä¼ ç»Ÿå‰é¦ˆç¥ç»ç½‘ç»œ (FNN):

è¾“å…¥å±‚     éšè—å±‚     è¾“å‡ºå±‚
  â—‹         â—‹          â—‹
  â—‹    â†’    â—‹    â†’     â—‹
  â—‹         â—‹          â—‹

é—®é¢˜ï¼šæ¯ä¸ªè¾“å…¥ç‹¬ç«‹å¤„ç†ï¼Œæ— æ³•å¤„ç†åºåˆ—å…³ç³»
```

**æ ¸å¿ƒé—®é¢˜**ï¼š
| ç½‘ç»œç±»å‹ | è¾“å…¥è¦æ±‚ | æ˜¯å¦æœ‰è®°å¿† | é€‚ç”¨åœºæ™¯ |
|---------|---------|----------|---------|
| å‰é¦ˆç¥ç»ç½‘ç»œ | å›ºå®šé•¿åº¦ | âŒ æ—  | å›¾åƒåˆ†ç±»ã€é™æ€æ•°æ® |
| å¾ªç¯ç¥ç»ç½‘ç»œ | å¯å˜é•¿åº¦ | âœ… æœ‰ | æ–‡æœ¬ã€è¯­éŸ³ã€æ—¶åºæ•°æ® |

### 1.2 åºåˆ—æ•°æ®çš„ç‰¹ç‚¹

```
"æˆ‘ çˆ± åŒ—äº¬ å¤©å®‰é—¨"
 â†“   â†“   â†“     â†“
 tâ‚  tâ‚‚  tâ‚ƒ    tâ‚„

æ¯ä¸ªè¯çš„ç†è§£ä¾èµ–äºå‰é¢çš„ä¸Šä¸‹æ–‡ï¼
```

**åºåˆ—æ•°æ®ç¤ºä¾‹**ï¼š

- ğŸ“ è‡ªç„¶è¯­è¨€ï¼šå¥å­æ˜¯è¯çš„åºåˆ—
- ğŸµ éŸ³é¢‘ï¼šå£°æ³¢æ˜¯é‡‡æ ·ç‚¹çš„åºåˆ—
- ğŸ“ˆ è‚¡ç¥¨ï¼šä»·æ ¼æ˜¯æ—¶é—´ç‚¹çš„åºåˆ—
- ğŸ§¬ DNAï¼šç¢±åŸºæ˜¯æ ¸è‹·é…¸çš„åºåˆ—

---

## 2. RNN åŸºç¡€æ¶æ„

### 2.1 æ ¸å¿ƒæ€æƒ³ï¼šå¾ªç¯è¿æ¥

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  RNN æ ¸å¿ƒæ€æƒ³                â”‚
â”‚                                             â”‚
â”‚     å½“å‰è¾“å‡º = f(å½“å‰è¾“å…¥, å†å²è®°å¿†)          â”‚
â”‚                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 RNN å•å…ƒç»“æ„

**æŠ˜å è§†å›¾ï¼ˆæ¦‚å¿µå›¾ï¼‰**ï¼š

```
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚        â”‚
    â”Œâ”€â”€â”€â†’â”‚  RNN   â”‚â”€â”€â”€â†’ è¾“å‡º yâ‚œ
    â”‚    â”‚  Cell  â”‚
    â”‚    â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
    â”‚        â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  (å¾ªç¯è¿æ¥)
         â†‘
       è¾“å…¥ xâ‚œ
```

**å±•å¼€è§†å›¾ï¼ˆæ—¶é—´åºåˆ—ï¼‰**ï¼š

```
    yâ‚        yâ‚‚        yâ‚ƒ        yâ‚„
    â†‘         â†‘         â†‘         â†‘
â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”
â”‚  hâ‚   â”‚â†’â”‚  hâ‚‚   â”‚â†’â”‚  hâ‚ƒ   â”‚â†’â”‚  hâ‚„   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”˜
    â†‘         â†‘         â†‘         â†‘
    xâ‚        xâ‚‚        xâ‚ƒ        xâ‚„
   "æˆ‘"      "çˆ±"     "åŒ—äº¬"   "å¤©å®‰é—¨"

   hâ‚€(åˆå§‹çŠ¶æ€ï¼Œé€šå¸¸ä¸º0å‘é‡)
```

### 2.3 å…³é”®æ¦‚å¿µ

| ç¬¦å·  | åç§°     | å«ä¹‰                          |
| ----- | -------- | ----------------------------- |
| `xâ‚œ`  | è¾“å…¥     | æ—¶åˆ» t çš„è¾“å…¥å‘é‡             |
| `hâ‚œ`  | éšè—çŠ¶æ€ | æ—¶åˆ» t çš„"è®°å¿†"ï¼Œç¼–ç å†å²ä¿¡æ¯ |
| `yâ‚œ`  | è¾“å‡º     | æ—¶åˆ» t çš„è¾“å‡º                 |
| `Wâ‚“â‚•` | è¾“å…¥æƒé‡ | è¾“å…¥åˆ°éšè—å±‚çš„æƒé‡çŸ©é˜µ        |
| `Wâ‚•â‚•` | å¾ªç¯æƒé‡ | éšè—å±‚åˆ°éšè—å±‚çš„æƒé‡çŸ©é˜µ      |
| `Wâ‚•áµ§` | è¾“å‡ºæƒé‡ | éšè—å±‚åˆ°è¾“å‡ºçš„æƒé‡çŸ©é˜µ        |

---

## 3. RNN çš„æ•°å­¦åŸç†

### 3.1 å‰å‘ä¼ æ’­å…¬å¼

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                             â”‚
â”‚   éšè—çŠ¶æ€:  hâ‚œ = tanh(Wâ‚“â‚• Â· xâ‚œ + Wâ‚•â‚• Â· hâ‚œâ‚‹â‚ + bâ‚•)         â”‚
â”‚                                                             â”‚
â”‚   è¾“å‡º:      yâ‚œ = softmax(Wâ‚•áµ§ Â· hâ‚œ + báµ§)                   â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å›¾è§£è®¡ç®—è¿‡ç¨‹**ï¼š

```
              hâ‚œâ‚‹â‚ (å‰ä¸€æ—¶åˆ»çš„éšè—çŠ¶æ€)
                â”‚
                â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”
            â”‚ Wâ‚•â‚•   â”‚
            â””â”€â”€â”€â”¬â”€â”€â”€â”˜
                â”‚
                â–¼
xâ‚œ â”€â”€â†’ [Wâ‚“â‚•] â”€â”€â†’ (+) â”€â”€â†’ [tanh] â”€â”€â†’ hâ‚œ â”€â”€â†’ [Wâ‚•áµ§] â”€â”€â†’ yâ‚œ
                 â†‘
                bâ‚• (åç½®)
```

### 3.2 è¯¦ç»†è®¡ç®—ç¤ºä¾‹

å‡è®¾ï¼š

- è¾“å…¥ç»´åº¦ï¼š`d = 3`
- éšè—å±‚ç»´åº¦ï¼š`h = 4`
- è¾“å‡ºç»´åº¦ï¼š`o = 2`

```python
# ç»´åº¦è¯´æ˜
xâ‚œ:   [3]       # è¾“å…¥å‘é‡
hâ‚œâ‚‹â‚: [4]       # ä¸Šä¸€æ—¶åˆ»éšè—çŠ¶æ€
Wâ‚“â‚•:  [4 Ã— 3]   # è¾“å…¥æƒé‡çŸ©é˜µ
Wâ‚•â‚•:  [4 Ã— 4]   # å¾ªç¯æƒé‡çŸ©é˜µ
bâ‚•:   [4]       # éšè—å±‚åç½®
Wâ‚•áµ§:  [2 Ã— 4]   # è¾“å‡ºæƒé‡çŸ©é˜µ
báµ§:   [2]       # è¾“å‡ºåç½®

# å‰å‘è®¡ç®—
hâ‚œ = tanh(Wâ‚“â‚• @ xâ‚œ + Wâ‚•â‚• @ hâ‚œâ‚‹â‚ + bâ‚•)  # shape: [4]
yâ‚œ = softmax(Wâ‚•áµ§ @ hâ‚œ + báµ§)             # shape: [2]
```

### 3.3 åå‘ä¼ æ’­ï¼šBPTT ç®—æ³•

**BPTTï¼ˆBack-Propagation Through Timeï¼‰**ï¼š

```
æ—¶é—´å±•å¼€åçš„åå‘ä¼ æ’­ï¼š

    âˆ‚L/âˆ‚yâ‚„   âˆ‚L/âˆ‚yâ‚ƒ   âˆ‚L/âˆ‚yâ‚‚   âˆ‚L/âˆ‚yâ‚
       â†“        â†“        â†“        â†“
    â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”
    â”‚  hâ‚„  â”‚â†â”‚  hâ‚ƒ  â”‚â†â”‚  hâ‚‚  â”‚â†â”‚  hâ‚  â”‚
    â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜
       â†“        â†“        â†“        â†“
    âˆ‚L/âˆ‚xâ‚„   âˆ‚L/âˆ‚xâ‚ƒ   âˆ‚L/âˆ‚xâ‚‚   âˆ‚L/âˆ‚xâ‚

æ¢¯åº¦æ²¿æ—¶é—´åå‘æµåŠ¨ï¼
```

**æƒé‡æ¢¯åº¦ç´¯åŠ **ï¼š

```
âˆ‚L/âˆ‚Wâ‚•â‚• = Î£â‚œ (âˆ‚L/âˆ‚hâ‚œ) Â· (âˆ‚hâ‚œ/âˆ‚Wâ‚•â‚•)
```

---

## 4. RNN çš„è‡´å‘½ç¼ºé™·

### 4.1 æ¢¯åº¦æ¶ˆå¤±é—®é¢˜

**é“¾å¼æ³•åˆ™å¯¼è‡´çš„æ¢¯åº¦è¡°å‡**ï¼š

```
âˆ‚hâ‚„/âˆ‚hâ‚ = âˆ‚hâ‚„/âˆ‚hâ‚ƒ Â· âˆ‚hâ‚ƒ/âˆ‚hâ‚‚ Â· âˆ‚hâ‚‚/âˆ‚hâ‚

        = Wâ‚•â‚•áµ€Â·diag(tanh'(zâ‚ƒ)) Â· Wâ‚•â‚•áµ€Â·diag(tanh'(zâ‚‚)) Â· Wâ‚•â‚•áµ€Â·diag(tanh'(zâ‚))
```

**é—®é¢˜å¯è§†åŒ–**ï¼š

```
tanhçš„å¯¼æ•°èŒƒå›´ï¼š(0, 1]

      1.0 â”ƒ      â•­â”€â”€â”€â”€â•®
          â”ƒ     â•±      â•²
          â”ƒ    â•±        â•²
      0.5 â”ƒ   â•±          â•²
          â”ƒ  â•±            â•²
      0.0 â”ƒâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
         -4   -2    0    2    4

å½“ |tanh'| < 1 æ—¶ï¼Œå¤šæ¬¡ç›¸ä¹˜ â†’ æ¢¯åº¦è¶‹å‘äº0
```

**å…·ä½“æ•°å€¼ç¤ºä¾‹**ï¼š

```
å‡è®¾æ¯æ­¥æ¢¯åº¦ä¹˜ä»¥ 0.5ï¼š

æ—¶é—´æ­¥æ•°    ç´¯ç§¯æ¢¯åº¦
   1         0.5
   5         0.03125
  10         0.001
  20         0.000001
  50         â‰ˆ 0

ç»“è®ºï¼šé•¿è·ç¦»ä¾èµ–ä¿¡æ¯æ— æ³•ä¼ é€’ï¼
```

### 4.2 æ¢¯åº¦çˆ†ç‚¸é—®é¢˜

```
å½“ ||Wâ‚•â‚•|| > 1 ä¸”æ¿€æ´»å‡½æ•°å¯¼æ•° > 1 æ—¶ï¼š

0.5 Ã— 2 Ã— 2 Ã— 2 Ã— 2 Ã— ... = âˆ

è§£å†³æ–¹æ¡ˆï¼šæ¢¯åº¦è£å‰ª (Gradient Clipping)
if ||gradient|| > threshold:
    gradient = threshold Ã— gradient / ||gradient||
```

### 4.3 é—®é¢˜æ€»ç»“

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     RNNçš„æ ¸å¿ƒé—®é¢˜                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  "The cat, which already ate a lot of food, was full"      â”‚
â”‚    â†‘                                                   â†‘    â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ è·ç¦»å¤ªè¿œï¼Œæ¢¯åº¦æ¶ˆå¤± â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                             â”‚
â”‚  RNNéš¾ä»¥å­¦ä¹ ï¼šä¸»è¯­"cat"ä¸è°“è¯­"was"çš„å¯¹åº”å…³ç³»               â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 5. LSTM è¯¦è§£

### 5.1 LSTM çš„æ ¸å¿ƒæ€æƒ³

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     LSTM = RNN + é—¨æ§æœºåˆ¶                    â”‚
â”‚                                                             â”‚
â”‚   æ ¸å¿ƒç†å¿µï¼š                                                 â”‚
â”‚   â€¢ å¢åŠ "ç»†èƒçŠ¶æ€"ä½œä¸ºä¿¡æ¯é«˜é€Ÿå…¬è·¯                          â”‚
â”‚   â€¢ ä½¿ç”¨"é—¨"æ¥æ§åˆ¶ä¿¡æ¯çš„ä¿ç•™ä¸é—å¿˜                          â”‚
â”‚   â€¢ æ¢¯åº¦å¯ä»¥æ— æŸåœ°é•¿è·ç¦»ä¼ æ’­                                 â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 LSTM å®Œæ•´ç»“æ„å›¾

```
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚              LSTM Cell                     â”‚
                        â”‚                                           â”‚
   Câ‚œâ‚‹â‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ âŠ— â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ âŠ• â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ Câ‚œ
                        â”‚                    â†‘                       â”‚
                        â”‚ (é—å¿˜é—¨)           â”‚ (è¾“å…¥é—¨)              â”‚
                        â”‚    fâ‚œ              â”‚  iâ‚œ âŠ— CÌƒâ‚œ             â”‚
                        â”‚    â†‘               â”‚    â†‘   â†‘              â”‚
                        â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                        â”‚  â”Œâ”€â”´â”€â”          â”Œâ”€â”€â”´â”€â” â”‚ â”Œâ”€â”´â”€â”            â”‚
                        â”‚  â”‚ Ïƒ â”‚          â”‚ Ïƒ  â”‚ â”‚ â”‚tanhâ”‚            â”‚
                        â”‚  â””â”€â”¬â”€â”˜          â””â”€â”€â”¬â”€â”˜ â”‚ â””â”€â”¬â”€â”˜            â”‚
                        â”‚    â”‚               â”‚   â”‚   â”‚               â”‚
                        â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”˜               â”‚
                        â”‚            â”‚                               â”‚
   hâ‚œâ‚‹â‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚â”€â”€â”€â”€â”€â”€â†’ [concat] â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ xâ‚œ
                        â”‚            â”‚                               â”‚
                        â”‚            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ oâ‚œ    â”‚
                        â”‚            â”‚                         â†“     â”‚
                        â”‚            â”‚                       â”Œâ”€â”€â”€â”   â”‚
                        â”‚            â”‚                       â”‚ Ïƒ â”‚   â”‚
                        â”‚            â”‚                       â””â”€â”¬â”€â”˜   â”‚
                        â”‚            â”‚                         â”‚     â”‚
                        â”‚            â”‚         Câ‚œ              â†“     â”‚
   hâ‚œ â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ tanh â”€â”€â”€â”€â”€â†’ âŠ— â”€â”€â”€â”€â”€â”€â”˜     â”‚
                        â”‚                                           â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ç¬¦å·è¯´æ˜ï¼š
âŠ— = é€å…ƒç´ ä¹˜æ³• (element-wise multiplication)
âŠ• = é€å…ƒç´ åŠ æ³• (element-wise addition)
Ïƒ = Sigmoidå‡½æ•°
```

### 5.3 ä¸‰ä¸ªé—¨è¯¦è§£

#### ğŸšª é—å¿˜é—¨ (Forget Gate)

```
ä½œç”¨ï¼šå†³å®šä»ç»†èƒçŠ¶æ€ä¸­ä¸¢å¼ƒä»€ä¹ˆä¿¡æ¯

       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚    fâ‚œ = Ïƒ(Wf Â· [hâ‚œâ‚‹â‚, xâ‚œ] + bf)    â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

hâ‚œâ‚‹â‚ â”€â”€â”
       â”œâ”€â”€â†’ [æ‹¼æ¥] â”€â”€â†’ [çº¿æ€§å˜æ¢] â”€â”€â†’ [Ïƒ] â”€â”€â†’ fâ‚œ âˆˆ (0,1)
xâ‚œ â”€â”€â”€â”€â”˜

è¾“å‡ºè§£é‡Šï¼š
â€¢ fâ‚œ â‰ˆ 1ï¼šä¿ç•™æ—§ä¿¡æ¯
â€¢ fâ‚œ â‰ˆ 0ï¼šé—å¿˜æ—§ä¿¡æ¯

ä¾‹å­ï¼šå¤„ç†æ–°å¥å­æ—¶ï¼Œé—å¿˜ä¹‹å‰å¥å­çš„ä¸»è¯­
```

#### ğŸšª è¾“å…¥é—¨ (Input Gate)

```
ä½œç”¨ï¼šå†³å®šä»€ä¹ˆæ–°ä¿¡æ¯å­˜å…¥ç»†èƒçŠ¶æ€

       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚    iâ‚œ = Ïƒ(Wi Â· [hâ‚œâ‚‹â‚, xâ‚œ] + bi)    â”‚  â† å†³å®šæ›´æ–°å“ªäº›ä½ç½®
       â”‚    CÌƒâ‚œ = tanh(Wc Â· [hâ‚œâ‚‹â‚, xâ‚œ] + bc) â”‚  â† ç”Ÿæˆå€™é€‰å€¼
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                  iâ‚œ (è¾“å…¥é—¨å€¼)
                    â†“
æ–°ä¿¡æ¯ â”€â”€â†’ [tanh] â”€â”€â†’ CÌƒâ‚œ â”€â”€â†’ (iâ‚œ âŠ— CÌƒâ‚œ) â”€â”€â†’ åŠ å…¥ç»†èƒçŠ¶æ€

ä¾‹å­ï¼šçœ‹åˆ°æ–°çš„ä¸»è¯­æ—¶ï¼Œå°†å…¶ä¿¡æ¯å­˜å…¥çŠ¶æ€
```

#### ğŸšª è¾“å‡ºé—¨ (Output Gate)

```
ä½œç”¨ï¼šå†³å®šç»†èƒçŠ¶æ€çš„å“ªäº›éƒ¨åˆ†ä½œä¸ºè¾“å‡º

       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚    oâ‚œ = Ïƒ(Wo Â· [hâ‚œâ‚‹â‚, xâ‚œ] + bo)    â”‚
       â”‚    hâ‚œ = oâ‚œ âŠ— tanh(Câ‚œ)              â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ç»†èƒçŠ¶æ€ Câ‚œ â”€â”€â†’ [tanh] â”€â”€â†’ (oâ‚œ âŠ— ...) â”€â”€â†’ hâ‚œ è¾“å‡º

ä¾‹å­ï¼šé¢„æµ‹ä¸‹ä¸€ä¸ªè¯æ—¶ï¼Œåªè¾“å‡ºä¸è¯­æ³•ç›¸å…³çš„éƒ¨åˆ†
```

### 5.4 ç»†èƒçŠ¶æ€æ›´æ–°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                             â”‚
â”‚    Câ‚œ = fâ‚œ âŠ— Câ‚œâ‚‹â‚ + iâ‚œ âŠ— CÌƒâ‚œ                               â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚
â”‚          ä¿ç•™æ—§     æ·»åŠ æ–°                                   â”‚
â”‚          ä¿¡æ¯       ä¿¡æ¯                                     â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ä¿¡æ¯æµå›¾è§£**ï¼š

```
æ—¶é—´æ­¥ t-1           æ—¶é—´æ­¥ t              æ—¶é—´æ­¥ t+1
    â”‚                   â”‚                     â”‚
    â–¼                   â–¼                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”             â”Œâ”€â”€â”€â”€â”€â”€â”€â”
â”‚ Câ‚œâ‚‹â‚  â”‚â”€â”€â†’ Ã—fâ‚œ â”€â”€â†’â”‚  +    â”‚â”€â”€â†’ Câ‚œ â”€â”€â†’  â”‚ Câ‚œâ‚Šâ‚  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”˜     â†‘     â”‚       â”‚             â””â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚     â”‚  â†‘    â”‚
              â”‚     â”‚ iâ‚œâŠ—CÌƒâ‚œ â”‚
              â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚         â†‘
         é—å¿˜é—¨      è¾“å…¥é—¨
         (ä¿ç•™å¤šå°‘)   (å†™å…¥å¤šå°‘)
```

### 5.5 ä¸ºä»€ä¹ˆ LSTM èƒ½è§£å†³æ¢¯åº¦é—®é¢˜ï¼Ÿ

```
å…³é”®ï¼šç»†èƒçŠ¶æ€çš„æ¢¯åº¦è·¯å¾„

âˆ‚Câ‚œ/âˆ‚Câ‚œâ‚‹â‚ = fâ‚œ  (ä»…æ˜¯ä¸€ä¸ªä¹˜æ³•ï¼)

å¯¹æ¯”RNNï¼š
âˆ‚hâ‚œ/âˆ‚hâ‚œâ‚‹â‚ = Wâ‚•â‚•áµ€ Â· diag(tanh'(zâ‚œ))  (çŸ©é˜µä¹˜æ³• + æ¿€æ´»å‡½æ•°å¯¼æ•°)

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                             â”‚
â”‚  LSTMç»†èƒçŠ¶æ€æ¢¯åº¦ï¼šâˆ‚Câ‚œâ‚Šâ‚™/âˆ‚Câ‚œ = fâ‚œâ‚Šâ‚™ Â· fâ‚œâ‚Šâ‚™â‚‹â‚ Â· ... Â· fâ‚œâ‚Šâ‚   â”‚
â”‚                                                             â”‚
â”‚  å½“ fâ‚œ â‰ˆ 1 æ—¶ï¼Œæ¢¯åº¦å‡ ä¹æ— æŸä¼ æ’­ï¼                            â”‚
â”‚  è¿™å°±æ˜¯"ä¿¡æ¯é«˜é€Ÿå…¬è·¯"çš„å«ä¹‰                                  â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 6. GRUï¼šLSTM çš„ç®€åŒ–ç‰ˆ

### 6.1 GRU ç»“æ„

```
GRU (Gated Recurrent Unit) - åªæœ‰ä¸¤ä¸ªé—¨

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                             â”‚
â”‚   é‡ç½®é—¨:  râ‚œ = Ïƒ(Wr Â· [hâ‚œâ‚‹â‚, xâ‚œ] + br)                    â”‚
â”‚   æ›´æ–°é—¨:  zâ‚œ = Ïƒ(Wz Â· [hâ‚œâ‚‹â‚, xâ‚œ] + bz)                    â”‚
â”‚   å€™é€‰å€¼:  hÌƒâ‚œ = tanh(Wh Â· [râ‚œ âŠ— hâ‚œâ‚‹â‚, xâ‚œ] + bh)            â”‚
â”‚   æ–°çŠ¶æ€:  hâ‚œ = (1 - zâ‚œ) âŠ— hâ‚œâ‚‹â‚ + zâ‚œ âŠ— hÌƒâ‚œ                  â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**GRU ç»“æ„å›¾**ï¼š

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚            GRU Cell            â”‚
                    â”‚                                â”‚
   hâ‚œâ‚‹â‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ âŠ— â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ âŠ• â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ hâ‚œ
           â”‚        â†‘ (1-zâ‚œ)         â†‘ (zâ‚œ)         â”‚
           â”‚        â”‚                â”‚               â”‚
           â”‚        â”‚        â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”      â”‚
           â”‚        â”‚        â”‚     tanh      â”‚      â”‚
           â”‚        â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
           â”‚        â”‚                â”‚               â”‚
           â”‚        â”‚     râ‚œ âŠ— hâ‚œâ‚‹â‚ + xâ‚œ           â”‚
           â”‚        â”‚        â†‘                       â”‚
           â”‚        â”‚       râ‚œ (é‡ç½®é—¨)              â”‚
           â”‚        zâ‚œ (æ›´æ–°é—¨)                      â”‚
           â”‚                                         â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ [concat with xâ‚œ] â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
                    â”‚                                â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.2 LSTM vs GRU å¯¹æ¯”

| ç‰¹æ€§     | LSTM                  | GRU                |
| -------- | --------------------- | ------------------ |
| é—¨çš„æ•°é‡ | 3 ä¸ª (é—å¿˜/è¾“å…¥/è¾“å‡º) | 2 ä¸ª (é‡ç½®/æ›´æ–°)   |
| çŠ¶æ€æ•°é‡ | 2 ä¸ª (h, C)           | 1 ä¸ª (h)           |
| å‚æ•°é‡   | 4 å€éšè—ç»´åº¦ Â²        | 3 å€éšè—ç»´åº¦ Â²     |
| è®¡ç®—é€Ÿåº¦ | è¾ƒæ…¢                  | è¾ƒå¿«               |
| æ€§èƒ½     | ç•¥ä¼˜                  | ç›¸è¿‘               |
| é€‚ç”¨åœºæ™¯ | é•¿åºåˆ—ã€å¤æ‚ä»»åŠ¡      | èµ„æºå—é™ã€å¿«é€Ÿå®éªŒ |

---

## 7. ä»£ç å®ç°

### 7.1 NumPy æ‰‹å†™ LSTM

```python
import numpy as np

class LSTMCell:
    """ä»é›¶å®ç°LSTMå•å…ƒ"""

    def __init__(self, input_size, hidden_size):
        self.input_size = input_size
        self.hidden_size = hidden_size

        # åˆå§‹åŒ–æƒé‡ (åˆå¹¶å››ä¸ªé—¨çš„æƒé‡)
        # ç»´åº¦: [4*hidden_size, input_size + hidden_size]
        combined_size = input_size + hidden_size
        scale = np.sqrt(2.0 / combined_size)

        # Wf, Wi, Wc, Wo åˆå¹¶
        self.W = np.random.randn(4 * hidden_size, combined_size) * scale
        self.b = np.zeros(4 * hidden_size)

    def sigmoid(self, x):
        return 1 / (1 + np.exp(-np.clip(x, -500, 500)))

    def forward(self, x, h_prev, c_prev):
        """
        å‰å‘ä¼ æ’­
        Args:
            x: å½“å‰è¾“å…¥ [batch_size, input_size]
            h_prev: ä¸Šä¸€æ—¶åˆ»éšè—çŠ¶æ€ [batch_size, hidden_size]
            c_prev: ä¸Šä¸€æ—¶åˆ»ç»†èƒçŠ¶æ€ [batch_size, hidden_size]
        Returns:
            h_next: å½“å‰éšè—çŠ¶æ€
            c_next: å½“å‰ç»†èƒçŠ¶æ€
        """
        H = self.hidden_size

        # æ‹¼æ¥è¾“å…¥å’Œä¸Šä¸€æ—¶åˆ»éšè—çŠ¶æ€
        combined = np.concatenate([x, h_prev], axis=1)  # [batch, input+hidden]

        # ä¸€æ¬¡è®¡ç®—æ‰€æœ‰é—¨
        gates = combined @ self.W.T + self.b  # [batch, 4*hidden]

        # åˆ†å‰²å››ä¸ªé—¨
        f_gate = self.sigmoid(gates[:, 0:H])           # é—å¿˜é—¨
        i_gate = self.sigmoid(gates[:, H:2*H])         # è¾“å…¥é—¨
        c_tilde = np.tanh(gates[:, 2*H:3*H])           # å€™é€‰ç»†èƒçŠ¶æ€
        o_gate = self.sigmoid(gates[:, 3*H:4*H])       # è¾“å‡ºé—¨

        # æ›´æ–°ç»†èƒçŠ¶æ€
        c_next = f_gate * c_prev + i_gate * c_tilde

        # è®¡ç®—éšè—çŠ¶æ€
        h_next = o_gate * np.tanh(c_next)

        # ä¿å­˜ä¸­é—´ç»“æœç”¨äºåå‘ä¼ æ’­
        self.cache = (x, h_prev, c_prev, combined,
                      f_gate, i_gate, c_tilde, o_gate, c_next)

        return h_next, c_next

    def backward(self, dh_next, dc_next):
        """
        åå‘ä¼ æ’­
        """
        x, h_prev, c_prev, combined, f, i, c_tilde, o, c_next = self.cache
        H = self.hidden_size

        # è¾“å‡ºé—¨çš„æ¢¯åº¦
        do = dh_next * np.tanh(c_next)
        do_gate = do * o * (1 - o)  # sigmoidå¯¼æ•°

        # ç»†èƒçŠ¶æ€çš„æ¢¯åº¦
        dc = dc_next + dh_next * o * (1 - np.tanh(c_next)**2)

        # é—å¿˜é—¨çš„æ¢¯åº¦
        df = dc * c_prev
        df_gate = df * f * (1 - f)

        # è¾“å…¥é—¨çš„æ¢¯åº¦
        di = dc * c_tilde
        di_gate = di * i * (1 - i)

        # å€™é€‰çŠ¶æ€çš„æ¢¯åº¦
        dc_tilde = dc * i
        dc_tilde_gate = dc_tilde * (1 - c_tilde**2)  # tanhå¯¼æ•°

        # åˆå¹¶é—¨çš„æ¢¯åº¦
        dgates = np.concatenate([df_gate, di_gate, dc_tilde_gate, do_gate], axis=1)

        # æƒé‡å’Œåç½®æ¢¯åº¦
        self.dW = dgates.T @ combined
        self.db = np.sum(dgates, axis=0)

        # è¾“å…¥å’Œä¸Šä¸€æ—¶åˆ»çŠ¶æ€çš„æ¢¯åº¦
        dcombined = dgates @ self.W
        dx = dcombined[:, :self.input_size]
        dh_prev = dcombined[:, self.input_size:]
        dc_prev = dc * f

        return dx, dh_prev, dc_prev


# æµ‹è¯•ä»£ç 
if __name__ == "__main__":
    batch_size = 2
    input_size = 3
    hidden_size = 4

    lstm = LSTMCell(input_size, hidden_size)

    # åˆå§‹åŒ–
    x = np.random.randn(batch_size, input_size)
    h = np.zeros((batch_size, hidden_size))
    c = np.zeros((batch_size, hidden_size))

    # å‰å‘ä¼ æ’­
    h_new, c_new = lstm.forward(x, h, c)
    print(f"è¾“å…¥å½¢çŠ¶: {x.shape}")
    print(f"éšè—çŠ¶æ€å½¢çŠ¶: {h_new.shape}")
    print(f"ç»†èƒçŠ¶æ€å½¢çŠ¶: {c_new.shape}")
```

### 7.2 PyTorch å®ç°

```python
import torch
import torch.nn as nn

class CustomLSTM(nn.Module):
    """PyTorchè‡ªå®šä¹‰LSTMå®ç°"""

    def __init__(self, input_size, hidden_size, num_layers=1, dropout=0.0):
        super().__init__()
        self.input_size = input_size
        self.hidden_size = hidden_size
        self.num_layers = num_layers

        # ä¸ºæ¯ä¸€å±‚åˆ›å»ºæƒé‡
        self.layers = nn.ModuleList()
        for i in range(num_layers):
            layer_input_size = input_size if i == 0 else hidden_size
            self.layers.append(nn.LSTMCell(layer_input_size, hidden_size))

        self.dropout = nn.Dropout(dropout)

    def forward(self, x, hidden=None):
        """
        Args:
            x: [seq_len, batch_size, input_size]
            hidden: (h_0, c_0) å„ä¸º [num_layers, batch_size, hidden_size]
        Returns:
            output: [seq_len, batch_size, hidden_size]
            (h_n, c_n): æœ€ç»ˆéšè—çŠ¶æ€
        """
        seq_len, batch_size, _ = x.size()

        # åˆå§‹åŒ–éšè—çŠ¶æ€
        if hidden is None:
            h = [torch.zeros(batch_size, self.hidden_size, device=x.device)
                 for _ in range(self.num_layers)]
            c = [torch.zeros(batch_size, self.hidden_size, device=x.device)
                 for _ in range(self.num_layers)]
        else:
            h = [hidden[0][i] for i in range(self.num_layers)]
            c = [hidden[1][i] for i in range(self.num_layers)]

        outputs = []

        for t in range(seq_len):
            inp = x[t]
            for layer_idx, layer in enumerate(self.layers):
                h[layer_idx], c[layer_idx] = layer(inp, (h[layer_idx], c[layer_idx]))
                inp = self.dropout(h[layer_idx]) if layer_idx < self.num_layers - 1 else h[layer_idx]
            outputs.append(inp)

        outputs = torch.stack(outputs, dim=0)
        h_n = torch.stack(h, dim=0)
        c_n = torch.stack(c, dim=0)

        return outputs, (h_n, c_n)


# ä½¿ç”¨å®˜æ–¹LSTM
class TextClassifier(nn.Module):
    """åŸºäºLSTMçš„æ–‡æœ¬åˆ†ç±»å™¨"""

    def __init__(self, vocab_size, embed_dim, hidden_dim, num_classes, num_layers=2):
        super().__init__()

        self.embedding = nn.Embedding(vocab_size, embed_dim, padding_idx=0)

        self.lstm = nn.LSTM(
            input_size=embed_dim,
            hidden_size=hidden_dim,
            num_layers=num_layers,
            batch_first=True,      # è¾“å…¥å½¢çŠ¶: [batch, seq, feature]
            bidirectional=True,    # åŒå‘LSTM
            dropout=0.3
        )

        self.fc = nn.Linear(hidden_dim * 2, num_classes)  # *2å› ä¸ºåŒå‘
        self.dropout = nn.Dropout(0.5)

    def forward(self, x):
        # x: [batch_size, seq_len]

        # è¯åµŒå…¥
        embedded = self.embedding(x)  # [batch, seq, embed_dim]

        # LSTMå¤„ç†
        lstm_out, (h_n, c_n) = self.lstm(embedded)
        # lstm_out: [batch, seq, hidden*2]
        # h_n: [num_layers*2, batch, hidden]

        # å–æœ€åä¸€å±‚çš„åŒå‘éšè—çŠ¶æ€
        forward_h = h_n[-2, :, :]   # å‰å‘æœ€åå±‚
        backward_h = h_n[-1, :, :]  # åå‘æœ€åå±‚
        hidden = torch.cat([forward_h, backward_h], dim=1)

        # åˆ†ç±»
        hidden = self.dropout(hidden)
        output = self.fc(hidden)

        return output


# è®­ç»ƒç¤ºä¾‹
def train_example():
    # è¶…å‚æ•°
    vocab_size = 10000
    embed_dim = 128
    hidden_dim = 256
    num_classes = 5
    batch_size = 32
    seq_len = 100

    # æ¨¡å‹
    model = TextClassifier(vocab_size, embed_dim, hidden_dim, num_classes)
    criterion = nn.CrossEntropyLoss()
    optimizer = torch.optim.Adam(model.parameters(), lr=0.001)

    # æ¨¡æ‹Ÿæ•°æ®
    x = torch.randint(0, vocab_size, (batch_size, seq_len))
    y = torch.randint(0, num_classes, (batch_size,))

    # è®­ç»ƒæ­¥éª¤
    model.train()
    optimizer.zero_grad()
    output = model(x)
    loss = criterion(output, y)
    loss.backward()

    # æ¢¯åº¦è£å‰ª
    torch.nn.utils.clip_grad_norm_(model.parameters(), max_norm=1.0)

    optimizer.step()

    print(f"æŸå¤±: {loss.item():.4f}")
    print(f"æ¨¡å‹å‚æ•°é‡: {sum(p.numel() for p in model.parameters()):,}")


if __name__ == "__main__":
    train_example()
```

### 7.3 å®Œæ•´è®­ç»ƒ pipeline

```python
import torch
import torch.nn as nn
from torch.utils.data import Dataset, DataLoader
from collections import Counter
import numpy as np

class TextDataset(Dataset):
    """æ–‡æœ¬æ•°æ®é›†"""

    def __init__(self, texts, labels, vocab=None, max_len=128):
        self.texts = texts
        self.labels = labels
        self.max_len = max_len

        if vocab is None:
            self.vocab = self._build_vocab(texts)
        else:
            self.vocab = vocab

    def _build_vocab(self, texts, min_freq=2):
        counter = Counter()
        for text in texts:
            counter.update(text.split())

        vocab = {'<PAD>': 0, '<UNK>': 1}
        for word, freq in counter.items():
            if freq >= min_freq:
                vocab[word] = len(vocab)
        return vocab

    def _encode(self, text):
        tokens = text.split()[:self.max_len]
        ids = [self.vocab.get(t, self.vocab['<UNK>']) for t in tokens]

        # å¡«å……
        if len(ids) < self.max_len:
            ids += [0] * (self.max_len - len(ids))

        return ids

    def __len__(self):
        return len(self.texts)

    def __getitem__(self, idx):
        return {
            'input_ids': torch.tensor(self._encode(self.texts[idx])),
            'label': torch.tensor(self.labels[idx])
        }


def train_loop(model, train_loader, val_loader, epochs=10, device='cuda'):
    """è®­ç»ƒå¾ªç¯"""

    model = model.to(device)
    criterion = nn.CrossEntropyLoss()
    optimizer = torch.optim.AdamW(model.parameters(), lr=1e-3, weight_decay=0.01)
    scheduler = torch.optim.lr_scheduler.CosineAnnealingLR(optimizer, epochs)

    best_acc = 0

    for epoch in range(epochs):
        # è®­ç»ƒ
        model.train()
        train_loss = 0
        for batch in train_loader:
            input_ids = batch['input_ids'].to(device)
            labels = batch['label'].to(device)

            optimizer.zero_grad()
            outputs = model(input_ids)
            loss = criterion(outputs, labels)
            loss.backward()

            # æ¢¯åº¦è£å‰ª
            torch.nn.utils.clip_grad_norm_(model.parameters(), 1.0)

            optimizer.step()
            train_loss += loss.item()

        # éªŒè¯
        model.eval()
        correct = 0
        total = 0
        with torch.no_grad():
            for batch in val_loader:
                input_ids = batch['input_ids'].to(device)
                labels = batch['label'].to(device)

                outputs = model(input_ids)
                _, predicted = torch.max(outputs, 1)
                total += labels.size(0)
                correct += (predicted == labels).sum().item()

        acc = correct / total
        scheduler.step()

        print(f"Epoch {epoch+1}/{epochs}")
        print(f"  Train Loss: {train_loss/len(train_loader):.4f}")
        print(f"  Val Accuracy: {acc:.4f}")

        if acc > best_acc:
            best_acc = acc
            torch.save(model.state_dict(), 'best_model.pt')

    print(f"\nBest Accuracy: {best_acc:.4f}")
```

---

## 8. å®æˆ˜åº”ç”¨

### 8.1 åº”ç”¨åœºæ™¯æ€»ç»“

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     RNN/LSTM åº”ç”¨é¢†åŸŸ                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  ğŸ“ è‡ªç„¶è¯­è¨€å¤„ç†                                                â”‚
â”‚     â€¢ æœºå™¨ç¿»è¯‘                                                  â”‚
â”‚     â€¢ æ–‡æœ¬åˆ†ç±»/æƒ…æ„Ÿåˆ†æ                                         â”‚
â”‚     â€¢ å‘½åå®ä½“è¯†åˆ«                                              â”‚
â”‚     â€¢ é—®ç­”ç³»ç»Ÿ                                                  â”‚
â”‚     â€¢ æ–‡æœ¬ç”Ÿæˆ                                                  â”‚
â”‚                                                                 â”‚
â”‚  ğŸµ è¯­éŸ³å¤„ç†                                                    â”‚
â”‚     â€¢ è¯­éŸ³è¯†åˆ« (ASR)                                            â”‚
â”‚     â€¢ è¯­éŸ³åˆæˆ (TTS)                                            â”‚
â”‚     â€¢ è¯´è¯äººè¯†åˆ«                                                â”‚
â”‚                                                                 â”‚
â”‚  ğŸ“ˆ æ—¶é—´åºåˆ—é¢„æµ‹                                                â”‚
â”‚     â€¢ è‚¡ä»·é¢„æµ‹                                                  â”‚
â”‚     â€¢ å¤©æ°”é¢„æŠ¥                                                  â”‚
â”‚     â€¢ æµé‡é¢„æµ‹                                                  â”‚
â”‚     â€¢ ä¼ æ„Ÿå™¨æ•°æ®åˆ†æ                                            â”‚
â”‚                                                                 â”‚
â”‚  ğŸ® å…¶ä»–                                                        â”‚
â”‚     â€¢ è§†é¢‘åˆ†æ                                                  â”‚
â”‚     â€¢ éŸ³ä¹ç”Ÿæˆ                                                  â”‚
â”‚     â€¢ æ‰‹å†™è¯†åˆ«                                                  â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 8.2 ä¸åŒä»»åŠ¡çš„ç½‘ç»œç»“æ„

```
1ï¸âƒ£ å¤šå¯¹ä¸€ (Many-to-One): æƒ…æ„Ÿåˆ†æ

   è¾“å…¥:  xâ‚ â†’ xâ‚‚ â†’ xâ‚ƒ â†’ xâ‚„ â†’ xâ‚…
          â†“    â†“    â†“    â†“    â†“
   RNN:   hâ‚ â†’ hâ‚‚ â†’ hâ‚ƒ â†’ hâ‚„ â†’ hâ‚…
                              â†“
   è¾“å‡º:                      y (æƒ…æ„Ÿæ ‡ç­¾)


2ï¸âƒ£ ä¸€å¯¹å¤š (One-to-Many): å›¾åƒæè¿°ç”Ÿæˆ

   è¾“å…¥:  x (å›¾åƒç‰¹å¾)
          â†“
   RNN:   hâ‚ â†’ hâ‚‚ â†’ hâ‚ƒ â†’ hâ‚„ â†’ hâ‚…
          â†“    â†“    â†“    â†“    â†“
   è¾“å‡º:  yâ‚   yâ‚‚   yâ‚ƒ   yâ‚„   yâ‚…
          "a"  "cat" "on" "the" "mat"


3ï¸âƒ£ å¤šå¯¹å¤š (Many-to-Many): åºåˆ—æ ‡æ³¨

   è¾“å…¥:  xâ‚ â†’ xâ‚‚ â†’ xâ‚ƒ â†’ xâ‚„ â†’ xâ‚…
          â†“    â†“    â†“    â†“    â†“
   RNN:   hâ‚ â†’ hâ‚‚ â†’ hâ‚ƒ â†’ hâ‚„ â†’ hâ‚…
          â†“    â†“    â†“    â†“    â†“
   è¾“å‡º:  yâ‚   yâ‚‚   yâ‚ƒ   yâ‚„   yâ‚…
          "B-PER" "I-PER" "O" "B-LOC" "O"


4ï¸âƒ£ Seq2Seq: æœºå™¨ç¿»è¯‘

   Encoder:
   xâ‚ â†’ xâ‚‚ â†’ xâ‚ƒ â†’  â”
   â†“    â†“    â†“     â”‚
   hâ‚ â†’ hâ‚‚ â†’ hâ‚ƒ â”€â”€â”€â”¼â†’ context
                   â”‚
   Decoder:        â”‚
         context â”€â”€â”˜
            â†“
   yâ‚ â†’ yâ‚‚ â†’ yâ‚ƒ â†’ yâ‚„
   "Je" "suis" "Ã©tudiant" "<EOS>"
```

### 8.3 åŒå‘ LSTM

```
å‰å‘:  hâ‚á¶  â†’ hâ‚‚á¶  â†’ hâ‚ƒá¶  â†’ hâ‚„á¶ 
        â†‘     â†‘     â†‘     â†‘
è¾“å…¥:  xâ‚    xâ‚‚    xâ‚ƒ    xâ‚„
        â†“     â†“     â†“     â†“
åå‘:  hâ‚áµ‡ â† hâ‚‚áµ‡ â† hâ‚ƒáµ‡ â† hâ‚„áµ‡

åˆå¹¶:  [hâ‚á¶ ;hâ‚áµ‡] [hâ‚‚á¶ ;hâ‚‚áµ‡] [hâ‚ƒá¶ ;hâ‚ƒáµ‡] [hâ‚„á¶ ;hâ‚„áµ‡]

ä¼˜åŠ¿ï¼šæ¯ä¸ªä½ç½®éƒ½èƒ½çœ‹åˆ°å®Œæ•´çš„ä¸Šä¸‹æ–‡
```

---

## 9. æ€»ç»“ä¸å±•æœ›

### 9.1 çŸ¥è¯†å›¾è°±

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚           åºåˆ—å»ºæ¨¡                  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚                        â”‚                        â”‚
            â–¼                        â–¼                        â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚   RNN    â”‚            â”‚   LSTM   â”‚            â”‚Transformerâ”‚
      â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
           â”‚                       â”‚                       â”‚
           â–¼                       â–¼                       â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚â€¢ ç»“æ„ç®€å•    â”‚        â”‚â€¢ è§£å†³æ¢¯åº¦é—®é¢˜â”‚        â”‚â€¢ å¹¶è¡Œè®¡ç®—    â”‚
    â”‚â€¢ æ¢¯åº¦æ¶ˆå¤±é—®é¢˜â”‚        â”‚â€¢ é•¿è·ç¦»ä¾èµ–  â”‚        â”‚â€¢ è‡ªæ³¨æ„åŠ›    â”‚
    â”‚â€¢ çŸ­åºåˆ—é€‚ç”¨  â”‚        â”‚â€¢ è®¡ç®—è¾ƒæ…¢    â”‚        â”‚â€¢ å½“å‰ä¸»æµ    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                                   â–¼
                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                            â”‚     GRU      â”‚
                            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                            â”‚ LSTMçš„ç®€åŒ–ç‰ˆ â”‚
                            â”‚ å‚æ•°æ›´å°‘     â”‚
                            â”‚ æ•ˆæœç›¸è¿‘     â”‚
                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 9.2 å…³é”®è¦ç‚¹å›é¡¾

| ä¸»é¢˜         | æ ¸å¿ƒè¦ç‚¹                                  |
| ------------ | ----------------------------------------- |
| **RNN åŸºç¡€** | é€šè¿‡å¾ªç¯è¿æ¥å¤„ç†åºåˆ—ï¼Œå…±äº«æƒé‡            |
| **æ¢¯åº¦é—®é¢˜** | é•¿åºåˆ—ä¸­æ¢¯åº¦æ¶ˆå¤±/çˆ†ç‚¸ï¼Œéš¾ä»¥å­¦ä¹ é•¿è·ç¦»ä¾èµ– |
| **LSTM**     | ä¸‰ä¸ªé—¨æ§æœºåˆ¶ + ç»†èƒçŠ¶æ€ = ä¿¡æ¯é«˜é€Ÿå…¬è·¯    |
| **GRU**      | ç®€åŒ–ç‰ˆ LSTMï¼Œä¸¤ä¸ªé—¨ï¼Œæ•ˆæœç›¸è¿‘             |
| **è®­ç»ƒæŠ€å·§** | æ¢¯åº¦è£å‰ªã€Dropoutã€Layer Normalization    |
| **åº”ç”¨**     | NLPã€è¯­éŸ³ã€æ—¶åºé¢„æµ‹ç­‰åºåˆ—ç›¸å…³ä»»åŠ¡         |

### 9.3 è¿›ä¸€æ­¥å­¦ä¹ 

```
ğŸ“š æ¨èèµ„æºï¼š

1. è®ºæ–‡
   â€¢ LSTM: "Long Short-Term Memory" (Hochreiter & Schmidhuber, 1997)
   â€¢ GRU: "Learning Phrase Representations..." (Cho et al., 2014)
   â€¢ Attention: "Attention Is All You Need" (Vaswani et al., 2017)

2. è¯¾ç¨‹
   â€¢ Stanford CS224N: NLP with Deep Learning
   â€¢ MIT 6.S191: Introduction to Deep Learning

3. ä»£ç 
   â€¢ PyTorchå®˜æ–¹æ•™ç¨‹
   â€¢ Hugging Face Transformersåº“

4. æ‰©å±•ä¸»é¢˜
   â€¢ Attentionæœºåˆ¶
   â€¢ Transformeræ¶æ„
   â€¢ é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹ (BERT, GPT)
```

### 9.4 RNN/LSTM vs Transformer

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ç°ä»£æ·±åº¦å­¦ä¹ çš„æ¼”è¿›                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                   â”‚
â”‚  2015-2017: RNN/LSTMæ—¶ä»£                                         â”‚
â”‚  â”œâ”€â”€ ä¼˜ç‚¹ï¼šé€‚åˆåºåˆ—å¤„ç†ï¼Œå‚æ•°å°‘                                   â”‚
â”‚  â””â”€â”€ ç¼ºç‚¹ï¼šéš¾ä»¥å¹¶è¡Œï¼Œé•¿è·ç¦»ä¾èµ–ä»æœ‰æŒ‘æˆ˜                           â”‚
â”‚                                                                   â”‚
â”‚  2017-è‡³ä»Š: Transformeræ—¶ä»£                                       â”‚
â”‚  â”œâ”€â”€ ä¼˜ç‚¹ï¼šå®Œå…¨å¹¶è¡Œï¼Œé€šè¿‡æ³¨æ„åŠ›æœºåˆ¶å»ºæ¨¡ä»»æ„è·ç¦»                   â”‚
â”‚  â””â”€â”€ ç¼ºç‚¹ï¼šè®¡ç®—é‡å¤§ï¼Œéœ€è¦ä½ç½®ç¼–ç                                  â”‚
â”‚                                                                   â”‚
â”‚  ä½†RNN/LSTMä»æœ‰ä»·å€¼ï¼š                                             â”‚
â”‚  â€¢ åœ¨çº¿/æµå¼å¤„ç†åœºæ™¯                                              â”‚
â”‚  â€¢ è®¡ç®—èµ„æºå—é™æ—¶                                                 â”‚
â”‚  â€¢ ä¸å…¶ä»–æ¶æ„ç»“åˆ                                                 â”‚
â”‚  â€¢ ç†è§£åºåˆ—å»ºæ¨¡çš„åŸºç¡€                                             â”‚
â”‚                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## é™„å½•ï¼šé€ŸæŸ¥è¡¨

### LSTM å…¬å¼é€ŸæŸ¥

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     LSTM å…¬å¼æ€»ç»“                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   é—å¿˜é—¨:  fâ‚œ = Ïƒ(Wf Â· [hâ‚œâ‚‹â‚, xâ‚œ] + bf)                        â”‚
â”‚                                                                 â”‚
â”‚   è¾“å…¥é—¨:  iâ‚œ = Ïƒ(Wi Â· [hâ‚œâ‚‹â‚, xâ‚œ] + bi)                        â”‚
â”‚                                                                 â”‚
â”‚   å€™é€‰å€¼:  CÌƒâ‚œ = tanh(Wc Â· [hâ‚œâ‚‹â‚, xâ‚œ] + bc)                     â”‚
â”‚                                                                 â”‚
â”‚   ç»†èƒæ€:  Câ‚œ = fâ‚œ âŠ™ Câ‚œâ‚‹â‚ + iâ‚œ âŠ™ CÌƒâ‚œ                           â”‚
â”‚                                                                 â”‚
â”‚   è¾“å‡ºé—¨:  oâ‚œ = Ïƒ(Wo Â· [hâ‚œâ‚‹â‚, xâ‚œ] + bo)                        â”‚
â”‚                                                                 â”‚
â”‚   éšè—æ€:  hâ‚œ = oâ‚œ âŠ™ tanh(Câ‚œ)                                  â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å¸¸è§é—®é¢˜è§£å†³

| é—®é¢˜         | è§£å†³æ–¹æ¡ˆ                        |
| ------------ | ------------------------------- |
| æ¢¯åº¦çˆ†ç‚¸     | æ¢¯åº¦è£å‰ª `clip_grad_norm`       |
| è¿‡æ‹Ÿåˆ       | Dropout, æ­£åˆ™åŒ–, æ•°æ®å¢å¼º       |
| è®­ç»ƒä¸ç¨³å®š   | Layer Normalization, å­¦ä¹ ç‡è°ƒåº¦ |
| é•¿åºåˆ—æ€§èƒ½å·® | ä½¿ç”¨ Attention, Transformer     |
| è®­ç»ƒå¤ªæ…¢     | ä½¿ç”¨ CuDNN ä¼˜åŒ–, å‡å°‘å±‚æ•°       |

---

> ğŸ“Œ **æ–‡æ¡£ä¿¡æ¯**
>
> - ç‰ˆæœ¬: 1.0
> - é€‚ç”¨å¯¹è±¡: æ·±åº¦å­¦ä¹ åˆå­¦è€…åˆ°ä¸­çº§å­¦ä¹ è€…
> - å»ºè®®: ç»“åˆä»£ç å®è·µç†è§£ç†è®º
