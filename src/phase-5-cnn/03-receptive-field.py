"""
03-receptive-field.py - æ„Ÿå—é‡è¯¦è§£

æœ¬èŠ‚å­¦ä¹ å†…å®¹ï¼š
1. ä»€ä¹ˆæ˜¯æ„Ÿå—é‡
2. æ„Ÿå—é‡çš„è®¡ç®—æ–¹æ³•
3. æœ‰æ•ˆæ„Ÿå—é‡ (Effective Receptive Field)
4. å¢å¤§æ„Ÿå—é‡çš„æ–¹æ³•
5. æ„Ÿå—é‡ä¸ç½‘ç»œè®¾è®¡çš„å…³ç³»
"""

import torch
import torch.nn as nn
import torch.nn.functional as F

print("=" * 60)
print("ç¬¬3èŠ‚: æ„Ÿå—é‡ (Receptive Field)")
print("=" * 60)

# ============================================================
# 1. ä»€ä¹ˆæ˜¯æ„Ÿå—é‡
# ============================================================
print("\nğŸ“Œ 1. æ„Ÿå—é‡çš„æ¦‚å¿µ")
print("-" * 40)

print("""
æ„Ÿå—é‡ (Receptive Field):
ç¥ç»ç½‘ç»œä¸­æŸä¸€å±‚çš„ä¸€ä¸ªç¥ç»å…ƒåœ¨è¾“å…¥å›¾åƒä¸Šæ‰€èƒ½"çœ‹åˆ°"çš„åŒºåŸŸå¤§å°

å¯è§†åŒ–ç¤ºæ„:

è¾“å…¥å±‚          ç¬¬1å±‚           ç¬¬2å±‚          ç¬¬3å±‚
(åŸå§‹å›¾åƒ)    (3Ã—3å·ç§¯å)    (å†3Ã—3å·ç§¯å)  (å†3Ã—3å·ç§¯å)

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚             â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  
â”‚ â”‚         â”‚ â”‚    â”Œâ”€â”€â”€â”€â”€â”
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â” â”‚ â”‚    â”‚     â”‚      â”Œâ”€â”€â”€â”
â”‚ â”‚ â”‚ â”Œâ”€â” â”‚ â”‚ â”‚ â†’  â”‚  â—  â”‚  â†’   â”‚ â— â”‚  â†’   â— å•ä¸ªç¥ç»å…ƒ
â”‚ â”‚ â”‚ â””â”€â”˜ â”‚ â”‚ â”‚    â”‚     â”‚      â””â”€â”€â”€â”˜      æ„Ÿå—é‡=7Ã—7
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”˜ â”‚ â”‚    â””â”€â”€â”€â”€â”€â”˜    
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   RF=3Ã—3      RF=5Ã—5
â”‚             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  RF=7Ã—7

æ¯å¢åŠ ä¸€å±‚3Ã—3å·ç§¯ï¼Œæ„Ÿå—é‡å¢åŠ 2
""")

# ============================================================
# 2. æ„Ÿå—é‡çš„è®¡ç®—
# ============================================================
print("\nğŸ“Œ 2. æ„Ÿå—é‡è®¡ç®—å…¬å¼")
print("-" * 40)

def calculate_rf(layers):
    """
    è®¡ç®—æ„Ÿå—é‡å¤§å°
    layers: [(kernel_size, stride, padding), ...]
    """
    rf = 1  # åˆå§‹æ„Ÿå—é‡
    cumulative_stride = 1  # ç´¯ç§¯æ­¥é•¿
    
    results = [("Input", 1, 1)]
    
    for i, (k, s, p) in enumerate(layers):
        # æ„Ÿå—é‡å¢åŠ é‡ = (kernel_size - 1) Ã— ç´¯ç§¯æ­¥é•¿
        rf += (k - 1) * cumulative_stride
        cumulative_stride *= s
        results.append((f"Layer {i+1} (k={k}, s={s})", rf, cumulative_stride))
    
    return results

# è®¡ç®—å…¬å¼
print("""
é€’æ¨å…¬å¼:
RF_l = RF_{l-1} + (K_l - 1) Ã— âˆ_{i=1}^{l-1} S_i

å…¶ä¸­:
- RF_l: ç¬¬lå±‚çš„æ„Ÿå—é‡
- K_l: ç¬¬lå±‚çš„å·ç§¯æ ¸å¤§å°
- S_i: ç¬¬iå±‚çš„æ­¥é•¿
""")

# ============================================================
# 3. ä¸åŒç½‘ç»œç»“æ„çš„æ„Ÿå—é‡
# ============================================================
print("\nğŸ“Œ 3. æ„Ÿå—é‡è®¡ç®—ç¤ºä¾‹")
print("-" * 40)

# ç¤ºä¾‹1: è¿ç»­3ä¸ª3Ã—3å·ç§¯
print("\nç¤ºä¾‹1: è¿ç»­3ä¸ª 3Ã—3 å·ç§¯ (stride=1)")
layers1 = [(3, 1, 1), (3, 1, 1), (3, 1, 1)]
results1 = calculate_rf(layers1)
for name, rf, stride in results1:
    print(f"  {name}: RF = {rf}Ã—{rf}")

# ç¤ºä¾‹2: VGGé£æ ¼ (3Ã—3å·ç§¯ + 2Ã—2æ± åŒ–)
print("\nç¤ºä¾‹2: VGGé£æ ¼ (Conv3Ã—3 + Pool2Ã—2)")
layers2 = [
    (3, 1, 1),  # Conv
    (2, 2, 0),  # Pool
    (3, 1, 1),  # Conv
    (2, 2, 0),  # Pool
    (3, 1, 1),  # Conv
]
results2 = calculate_rf(layers2)
for name, rf, stride in results2:
    print(f"  {name}: RF = {rf}Ã—{rf}, ç´¯ç§¯stride = {stride}")

# ç¤ºä¾‹3: ä¸€ä¸ª7Ã—7å·ç§¯ vs ä¸‰ä¸ª3Ã—3å·ç§¯
print("\nç¤ºä¾‹3: 7Ã—7 vs ä¸‰ä¸ª3Ã—3")
print("  å•ä¸ª 7Ã—7 å·ç§¯: RF = 7Ã—7")
print("  ä¸‰ä¸ª 3Ã—3 å·ç§¯: RF = 7Ã—7")
print("  ä½†ä¸‰ä¸ª3Ã—3å‚æ•°æ›´å°‘: 3Ã—(3Ã—3) = 27 < 7Ã—7 = 49")

# ============================================================
# 4. æœ‰æ•ˆæ„Ÿå—é‡
# ============================================================
print("\nğŸ“Œ 4. æœ‰æ•ˆæ„Ÿå—é‡ (Effective Receptive Field)")
print("-" * 40)

print("""
ç†è®ºæ„Ÿå—é‡ vs æœ‰æ•ˆæ„Ÿå—é‡:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                         â”‚
â”‚   ç†è®ºæ„Ÿå—é‡: æœ€å¤–åœˆåƒç´ å¯¹è¾“å‡ºæœ‰å½±å“                     â”‚
â”‚                                                         â”‚
â”‚   æœ‰æ•ˆæ„Ÿå—é‡: ä¸­å¿ƒåŒºåŸŸè´¡çŒ®æ›´å¤§ (ç±»ä¼¼é«˜æ–¯åˆ†å¸ƒ)            â”‚
â”‚                                                         â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                               â”‚
â”‚         â”‚ . . . . . . . â”‚  ç†è®ºæ„Ÿå—é‡è¾¹ç•Œ               â”‚
â”‚         â”‚ . â–‘â–‘â–‘â–‘â–‘â–‘â–‘ . . â”‚                               â”‚
â”‚         â”‚ . â–‘â–“â–“â–“â–“â–“â–‘ . . â”‚  æœ‰æ•ˆæ„Ÿå—é‡åŒºåŸŸ               â”‚
â”‚         â”‚ . â–‘â–“â–ˆâ–ˆâ–ˆâ–“â–‘ . . â”‚                               â”‚
â”‚         â”‚ . â–‘â–“â–“â–“â–“â–“â–‘ . . â”‚  ä¸­å¿ƒåŒºåŸŸè´¡çŒ®æœ€å¤§             â”‚
â”‚         â”‚ . â–‘â–‘â–‘â–‘â–‘â–‘â–‘ . . â”‚                               â”‚
â”‚         â”‚ . . . . . . . â”‚                               â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å®é™…ä¸Šï¼Œæœ‰æ•ˆæ„Ÿå—é‡çº¦ä¸ºç†è®ºæ„Ÿå—é‡çš„ 0.3-0.5 å€
""")

# ============================================================
# 5. å¢å¤§æ„Ÿå—é‡çš„æ–¹æ³•
# ============================================================
print("\nğŸ“Œ 5. å¢å¤§æ„Ÿå—é‡çš„æ–¹æ³•")
print("-" * 40)

print("""
æ–¹æ³•1: å¢åŠ ç½‘ç»œæ·±åº¦
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ›´å¤šå·ç§¯å±‚ â†’ æ›´å¤§æ„Ÿå—é‡              â”‚
â”‚  ä¾‹: 3ä¸ª3Ã—3å·ç§¯ â†’ RF=7               â”‚
â”‚      5ä¸ª3Ã—3å·ç§¯ â†’ RF=11              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æ–¹æ³•2: ä½¿ç”¨æ± åŒ–å±‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ± åŒ–å¢åŠ æ­¥é•¿ â†’ åç»­å±‚æ„Ÿå—é‡å¿«é€Ÿå¢é•¿  â”‚
â”‚  ä¾‹: 3Ã—3conv + 2Ã—2pool + 3Ã—3conv     â”‚
â”‚      RF = 1 + 2 + 2Ã—2 = 7            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æ–¹æ³•3: ä½¿ç”¨å¤§æ­¥é•¿å·ç§¯
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  stride > 1 çš„å·ç§¯                   â”‚
â”‚  ä¾‹: 7Ã—7 conv, stride=2 (ResNetç¬¬ä¸€å±‚)â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æ–¹æ³•4: ç©ºæ´å·ç§¯ (Dilated Convolution)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ä¸å¢åŠ å‚æ•°çš„æƒ…å†µä¸‹æ‰©å¤§æ„Ÿå—é‡         â”‚
â”‚  dilation=2: 3Ã—3æ ¸çš„æ„Ÿå—é‡å˜æˆ5Ã—5    â”‚
â”‚  dilation=4: 3Ã—3æ ¸çš„æ„Ÿå—é‡å˜æˆ9Ã—9    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
""")

# ============================================================
# 6. ç©ºæ´å·ç§¯è¯¦è§£
# ============================================================
print("\nğŸ“Œ 6. ç©ºæ´å·ç§¯ (Dilated/Atrous Convolution)")
print("-" * 40)

print("""
æ™®é€š3Ã—3å·ç§¯ (dilation=1):     ç©ºæ´3Ã—3å·ç§¯ (dilation=2):

    â–¡ â–¡ â–¡                         â–¡   â–¡   â–¡
    â–¡ â–¡ â–¡                           
    â–¡ â–¡ â–¡                         â–¡   â–¡   â–¡
                                    
    RF = 3Ã—3                      â–¡   â–¡   â–¡
                                  
                                  RF = 5Ã—5 (å‚æ•°ä»æ˜¯9ä¸ª)
""")

# ä»£ç æ¼”ç¤º
input_8x8 = torch.randn(1, 1, 8, 8)

# æ™®é€šå·ç§¯
conv_normal = nn.Conv2d(1, 1, kernel_size=3, padding=1, dilation=1)
out_normal = conv_normal(input_8x8)

# ç©ºæ´å·ç§¯
conv_dilated = nn.Conv2d(1, 1, kernel_size=3, padding=2, dilation=2)
out_dilated = conv_dilated(input_8x8)

print(f"\nè¾“å…¥å½¢çŠ¶: {input_8x8.shape}")
print(f"æ™®é€š3Ã—3å·ç§¯è¾“å‡º: {out_normal.shape}")
print(f"ç©ºæ´3Ã—3å·ç§¯(d=2)è¾“å‡º: {out_dilated.shape}")

# ç©ºæ´å·ç§¯æœ‰æ•ˆæ ¸å¤§å°
def effective_kernel_size(k, d):
    """è®¡ç®—ç©ºæ´å·ç§¯çš„æœ‰æ•ˆæ ¸å¤§å°"""
    return k + (k - 1) * (d - 1)

print("\nç©ºæ´å·ç§¯æœ‰æ•ˆæ ¸å¤§å°:")
for dilation in [1, 2, 4, 8]:
    eff_k = effective_kernel_size(3, dilation)
    print(f"  kernel=3, dilation={dilation} â†’ æœ‰æ•ˆæ ¸å¤§å° = {eff_k}Ã—{eff_k}")

# ============================================================
# 7. æ„Ÿå—é‡ä¸ä»»åŠ¡çš„å…³ç³»
# ============================================================
print("\nğŸ“Œ 7. æ„Ÿå—é‡ä¸ä»»åŠ¡çš„å…³ç³»")
print("-" * 40)

print("""
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      ä»»åŠ¡        â”‚          æ„Ÿå—é‡è¦æ±‚                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  è¾¹ç¼˜æ£€æµ‹        â”‚  å°æ„Ÿå—é‡ (3-5åƒç´ )                  â”‚
â”‚  çº¹ç†è¯†åˆ«        â”‚  ä¸­ç­‰æ„Ÿå—é‡ (10-30åƒç´ )              â”‚
â”‚  ç›®æ ‡æ£€æµ‹        â”‚  è¾ƒå¤§æ„Ÿå—é‡ (è¦†ç›–ç›®æ ‡å°ºå¯¸)           â”‚
â”‚  è¯­ä¹‰åˆ†å‰²        â”‚  å¤§æ„Ÿå—é‡ (ç†è§£ä¸Šä¸‹æ–‡)               â”‚
â”‚  å›¾åƒåˆ†ç±»        â”‚  å…¨å±€æ„Ÿå—é‡ (è¦†ç›–æ•´ä¸ªå›¾åƒ)           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ç»éªŒæ³•åˆ™:
- æ„Ÿå—é‡åº”è¯¥è‡³å°‘è¦†ç›–ä½ è¦è¯†åˆ«çš„ç›®æ ‡å¤§å°
- åˆ†ç±»ä»»åŠ¡: æ„Ÿå—é‡åº”è¦†ç›–æ•´ä¸ªè¾“å…¥å›¾åƒ
- åˆ†å‰²ä»»åŠ¡: éœ€è¦å¤šå°ºåº¦æ„Ÿå—é‡
""")

# ============================================================
# 8. å®é™…ç½‘ç»œçš„æ„Ÿå—é‡åˆ†æ
# ============================================================
print("\nğŸ“Œ 8. ç»å…¸ç½‘ç»œçš„æ„Ÿå—é‡")
print("-" * 40)

# VGG-16æ„Ÿå—é‡è®¡ç®—
print("\nVGG-16 æ„Ÿå—é‡åˆ†æ:")
vgg_layers = [
    # ç¬¬ä¸€ä¸ªblock
    (3, 1, 1), (3, 1, 1), (2, 2, 0),  # 2ä¸ªconv + pool
    # ç¬¬äºŒä¸ªblock
    (3, 1, 1), (3, 1, 1), (2, 2, 0),
    # ç¬¬ä¸‰ä¸ªblock
    (3, 1, 1), (3, 1, 1), (3, 1, 1), (2, 2, 0),
    # ç¬¬å››ä¸ªblock
    (3, 1, 1), (3, 1, 1), (3, 1, 1), (2, 2, 0),
    # ç¬¬äº”ä¸ªblock
    (3, 1, 1), (3, 1, 1), (3, 1, 1), (2, 2, 0),
]

results_vgg = calculate_rf(vgg_layers)
print(f"  æœ€ç»ˆæ„Ÿå—é‡: {results_vgg[-1][1]}Ã—{results_vgg[-1][1]}")
print(f"  ç´¯ç§¯æ­¥é•¿: {results_vgg[-1][2]}")

# ResNetåˆ†æ
print("\nResNet-50 ç¬¬ä¸€ä¸ªstageæ„Ÿå—é‡:")
resnet_first_stage = [
    (7, 2, 3),   # 7Ã—7 conv, stride 2
    (3, 2, 1),   # MaxPool
]
results_resnet = calculate_rf(resnet_first_stage)
for name, rf, stride in results_resnet:
    print(f"  {name}: RF = {rf}Ã—{rf}")

# ============================================================
# 9. æ„Ÿå—é‡å¯è§†åŒ–å·¥å…·
# ============================================================
print("\nğŸ“Œ 9. æ„Ÿå—é‡è®¡ç®—å·¥å…·ç±»")
print("-" * 40)

class ReceptiveFieldCalculator:
    """æ„Ÿå—é‡è®¡ç®—å™¨"""
    
    def __init__(self):
        self.layers = []
        self.rf_history = [(1, 1)]  # (rf, cumulative_stride)
    
    def add_conv(self, kernel_size, stride=1, dilation=1):
        """æ·»åŠ å·ç§¯å±‚"""
        effective_k = kernel_size + (kernel_size - 1) * (dilation - 1)
        self.layers.append(('Conv', effective_k, stride))
        self._update_rf(effective_k, stride)
        return self
    
    def add_pool(self, kernel_size, stride=None):
        """æ·»åŠ æ± åŒ–å±‚"""
        if stride is None:
            stride = kernel_size
        self.layers.append(('Pool', kernel_size, stride))
        self._update_rf(kernel_size, stride)
        return self
    
    def _update_rf(self, k, s):
        """æ›´æ–°æ„Ÿå—é‡"""
        prev_rf, prev_stride = self.rf_history[-1]
        new_rf = prev_rf + (k - 1) * prev_stride
        new_stride = prev_stride * s
        self.rf_history.append((new_rf, new_stride))
    
    def get_rf(self):
        """è·å–å½“å‰æ„Ÿå—é‡"""
        return self.rf_history[-1][0]
    
    def summary(self):
        """æ‰“å°æ‘˜è¦"""
        print("\nå±‚æ¬¡ç»“æ„å’Œæ„Ÿå—é‡å˜åŒ–:")
        print(f"  Input: RF = 1")
        for i, ((layer_type, k, s), (rf, stride)) in enumerate(
            zip(self.layers, self.rf_history[1:])
        ):
            print(f"  {layer_type}(k={k}, s={s}): RF = {rf}, stride = {stride}")

# ä½¿ç”¨ç¤ºä¾‹
calc = ReceptiveFieldCalculator()
calc.add_conv(3).add_conv(3).add_pool(2, 2).add_conv(3).add_conv(3)
calc.summary()

# ============================================================
# ç»ƒä¹ é¢˜
# ============================================================
print("\n" + "=" * 60)
print("ğŸ’¡ ç»ƒä¹ é¢˜")
print("=" * 60)

print("""
1. 5ä¸ª3Ã—3å·ç§¯å±‚(stride=1)å †å åçš„æ„Ÿå—é‡æ˜¯å¤šå°‘ï¼Ÿ

2. ä¸€ä¸ª3Ã—3å·ç§¯(s=1) + ä¸€ä¸ª2Ã—2æ± åŒ–(s=2) + ä¸€ä¸ª3Ã—3å·ç§¯(s=1)
   çš„æ„Ÿå—é‡æ˜¯å¤šå°‘ï¼Ÿ

3. å¦‚ä½•ç”¨ç©ºæ´å·ç§¯è®©3Ã—3å·ç§¯æ ¸è¾¾åˆ°7Ã—7çš„æ„Ÿå—é‡ï¼Ÿ

4. ä¸ºä»€ä¹ˆè¯­ä¹‰åˆ†å‰²ä»»åŠ¡éœ€è¦å¤§æ„Ÿå—é‡ï¼Ÿ
""")

# ============================================================
# æ€»ç»“
# ============================================================
print("\n" + "=" * 60)
print("ğŸ“ æœ¬èŠ‚è¦ç‚¹æ€»ç»“")
print("=" * 60)

print("""
1. æ„Ÿå—é‡: CNNç¥ç»å…ƒèƒ½"çœ‹åˆ°"çš„è¾“å…¥åŒºåŸŸå¤§å°

2. è®¡ç®—å…¬å¼: RF_l = RF_{l-1} + (K-1) Ã— ç´¯ç§¯æ­¥é•¿

3. å¢å¤§æ„Ÿå—é‡çš„æ–¹æ³•:
   - å †å æ›´å¤šå·ç§¯å±‚
   - ä½¿ç”¨æ± åŒ–å±‚
   - ä½¿ç”¨ç©ºæ´å·ç§¯
   - å¢å¤§æ­¥é•¿

4. æœ‰æ•ˆæ„Ÿå—é‡ â‰ˆ ç†è®ºæ„Ÿå—é‡çš„ 0.3-0.5 å€

5. è®¾è®¡åŸåˆ™: æ„Ÿå—é‡åº”è¯¥è¦†ç›–è¦è¯†åˆ«çš„ç›®æ ‡

ä¸‹ä¸€èŠ‚: LeNet æ¶æ„å®ç°
""")
