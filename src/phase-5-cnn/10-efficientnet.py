"""
10-efficientnet.py - EfficientNet å¤åˆç¼©æ”¾

æœ¬èŠ‚å­¦ä¹ : å¤åˆç¼©æ”¾ç­–ç•¥ã€EfficientNet æ¶æ„
"""
import torch
from torchvision import models

print("=" * 60)
print("ç¬¬10èŠ‚: EfficientNet")
print("=" * 60)

print("""
ğŸ“Œ EfficientNet æ ¸å¿ƒæ€æƒ³: å¤åˆç¼©æ”¾ (Compound Scaling)

ä¼ ç»Ÿæ–¹æ³•åªç¼©æ”¾å•ä¸€ç»´åº¦:
- æ·±åº¦ç¼©æ”¾: æ›´å¤šå±‚
- å®½åº¦ç¼©æ”¾: æ›´å¤šé€šé“
- åˆ†è¾¨ç‡ç¼©æ”¾: æ›´å¤§è¾“å…¥

EfficientNet: åŒæ—¶ç¼©æ”¾ä¸‰ä¸ªç»´åº¦!
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

  æ·±åº¦: d = Î±^Ï†
  å®½åº¦: w = Î²^Ï†  
  åˆ†è¾¨ç‡: r = Î³^Ï†
  
  çº¦æŸ: Î± Ã— Î²Â² Ã— Î³Â² â‰ˆ 2

EfficientNet å®¶æ—:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   æ¨¡å‹      â”‚ å‚æ•°é‡ â”‚  Top-1 Acc â”‚ è¾“å…¥å°ºå¯¸ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ EfficientNet-B0 â”‚ 5.3M â”‚   77.1%    â”‚   224   â”‚
â”‚ EfficientNet-B1 â”‚ 7.8M â”‚   79.1%    â”‚   240   â”‚
â”‚ EfficientNet-B2 â”‚ 9.2M â”‚   80.1%    â”‚   260   â”‚
â”‚ EfficientNet-B3 â”‚ 12M  â”‚   81.6%    â”‚   300   â”‚
â”‚ EfficientNet-B4 â”‚ 19M  â”‚   82.9%    â”‚   380   â”‚
â”‚ EfficientNet-B5 â”‚ 30M  â”‚   83.6%    â”‚   456   â”‚
â”‚ EfficientNet-B6 â”‚ 43M  â”‚   84.0%    â”‚   528   â”‚
â”‚ EfficientNet-B7 â”‚ 66M  â”‚   84.3%    â”‚   600   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
""")

# ä½¿ç”¨é¢„è®­ç»ƒ EfficientNet
model = models.efficientnet_b0(weights=models.EfficientNet_B0_Weights.IMAGENET1K_V1)
params = sum(p.numel() for p in model.parameters())
print(f"EfficientNet-B0 å‚æ•°é‡: {params/1e6:.1f}M")

x = torch.randn(2, 3, 224, 224)
print(f"è¾“å…¥: {x.shape} â†’ è¾“å‡º: {model(x).shape}")

print("""
ğŸ“ è¦ç‚¹æ€»ç»“:
1. å¤åˆç¼©æ”¾: åŒæ—¶è°ƒæ•´æ·±åº¦ã€å®½åº¦ã€åˆ†è¾¨ç‡
2. åŸºäº MobileNet V2 çš„ MBConv å—
3. ä½¿ç”¨ç¥ç»æ¶æ„æœç´¢ (NAS) æ‰¾åˆ°æœ€ä¼˜åŸºç¡€ç½‘ç»œ
4. åœ¨ç›¸åŒç²¾åº¦ä¸‹ï¼Œå‚æ•°é‡å’Œè®¡ç®—é‡éƒ½æ›´å°‘
""")
